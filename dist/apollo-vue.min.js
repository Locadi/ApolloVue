!function(){var t={data:function(){return{asyncInit:!0}},compiled:function(){"absolute"===this.asyncType&&$(this.$el).css({position:"absolute"}),$(this.$el).css({visibility:"hidden"})},methods:{resolveInit:function(){"absolute"===this.asyncType&&$(this.$el).css({position:""}),$(this.$el).css({visibility:""})}}},e={props:["data-provider"],data:function(){return{dataLoaded:!1,loading:!1}},beforeCompile:function(){return this.autoLoad?"function"!=typeof this.afterDataLoaded?void r.warn("autoLoad is true but component didn't implement afterDataLoaded. set autoLoad=false to manual load data or implement afterDataLoaded"):void this.loadData().then(function(t){this.afterDataLoaded(t)}.bind(this)):void 0},methods:{loadData:function(t){return this.loading=!0,new Promise(function(e){var n=r.getDataProviderObject(this.dataProvider||this.defaultDataProvider);return n?("function"!=typeof this.getDateProviderConfig||t||(t=this.getDateProviderConfig()),t=t||{},t["component-name"]=r.getComponentTagName(this),n.data?void("function"==typeof n.data?(this.loading=!1,e(n.data(t),!0),this.dataLoaded=!0):(this.loading=!1,e(n.data,!0),this.dataLoaded=!0)):void("function"==typeof n?n(t).then(function(t){this.loading=!1,e(t),this.dataLoaded=!0}.bind(this)):n.load?n.load(t).then(function(t){this.loading=!1,e(t),this.dataLoaded=!0}.bind(this)):r.warn("unkown data provider object."))):void r.warn("data provider was not set for this component: "+r.getComponentTagName(this))}.bind(this))}}},n={created:function(){var t=[];if("function"==typeof this.getDataSyncConfig){var e=this.getDataSyncConfig();if(!e)return void r.warn("getDataSyncConfig return null data array");t=e}else{var n;if(this.dataSyncPattern?n=this.dataSyncPattern:r.config.dataSyncPattern&&(n=r.config.dataSyncPattern),!n)return void r.warn("no pattern was found for the data sync. either remove the data sync mixin from the component or provide dataSyncPattern property in the component or in the config.");if(!(n instanceof RegExp))try{n=new RegExp(n)}catch(i){return void r.warn("pattern is not a valid regular expression string",i)}for(var a in this)n.test(a)&&"function"!=typeof this[a]&&"dataSyncPattern"!==a&&t.push({name:a,trigger:!0,listen:!0,callbackName:"onDataSync",setDataWhenNoCallback:!0})}for(var o=this,s=0;s<t.length;s++)(function(){var e=t[s].name,n=t[s].callbackName,i=t[s].setDataWhenNoCallback;t[s].listen&&r.registerForPropertyChange(o,e,function(t,e,a){"function"==typeof this[n]?this[n](t,e,a):i&&(this[t]=e)}.bind(this)),t[s].trigger&&this.$watch(e,function(t,n){r.reportPropertyChanged(o,e,t,n)}.bind(this))}).bind(this)()}},i={created:function(){var t=$(this.$options.template).get(0);if(!t){r.debug("template "+this.$options.template+" was not found. trying to load from server","DynamicTemplateMixin");var e=this.$options.template.replace(/#/,""),n=this.$options.el.outerHTML;this.$options.template='<div style="display:none;"></div>',s.templates.load(e).then(function(t){if(!t||!t.length)return void r.warn("no template was found");r.debug("template loaded successfully","DynamicTemplateMixin");var i=$('<script id="'+e+'" type="text/template">'+t+"</script>");$("body").append(i);var a=this.$el,o=$(n).get(0);for(var d in this._props)$(o).attr(this._props[d].name,this._props[d].raw);this.$destroy(),$(a).replaceWith(o),s.components.render()}.bind(this))}}},a={ready:function(){if(!this.events||!this.events.length)return void r.debug("no events were defined for the event mixin","EventsMixin");for(var t=0;t<this.events.length;t++){var e,n=this.events[t],i={},a=null;if("string"==typeof n){if(/:event-/.test(n)?(a=r.CONST.EVENT_TYPE_TRIGGER,i.name=n,e=n.match(/:event-(.*)/),e&&e[1]&&(e=r.kebabToCamel(e[1]),i.fireFn="fire"+r.capitalize(e))):/:command-/.test(n)&&(a=r.CONST.EVENT_TYPE_LISTENER,i.name=n,e=n.match(/:command-(.*)/),e&&e[1]&&(e=r.kebabToCamel(e[1]),i.handlerFn=e)),!a){r.warn("event name="+n+" is not recognized by the ApolloVue events standards. event name must starts with *:event-* or *:command-*");continue}}else i=n;if(i.name&&i.name.length)if(i.handlerFn||i.fireFn){if(i.handlerFn){if("function"!=typeof this[i.handlerFn]){r.warn("method "+i.handlerFn+" was not implemented by component but defined in events");continue}i.selector?$(this.$el).on(i.name,i.selector,this[i.handlerFn].bind(this)):$(this.$el).on(i.name,this[i.handlerFn].bind(this))}if(i.fireFn){if(this[i.fireFn]){r.warn("method "+i.fireFn+" was already implemented by component, so auto generated method is ignored");continue}(function(){var t=i.name;this[i.fireFn]=function(e,n){this.fire(t,e,n)}}).bind(this)()}}else r.warn("you must provide either handlerFn or fireFn. please check in the events index number "+t);else r.warn("event must provide a name. please check in the events index number "+t)}},methods:{fire:function(t,e,n){var i="null";if(e)try{i=window.JSON.stringify(e)}catch(a){}r.debug("firing event "+t+" with data="+i,"EventsMixin"),n=n||$(this.$el),n.trigger(t,e)}}},o={props:["templates"],created:function(){if(this.templates&&this.templates.length){var t=r.getComponentTagName(this);r.debug("found templates attribute for "+t,"TemplateMixin"),this.templates=this.templates.split(","),this.$options.template="#"+this.templates[0]}}},r={config:null,watchers:{},lastWatchData:{},dataProviders:{},CONST:{EVENT_TYPE_LISTENER:1,EVENT_TYPE_TRIGGER:2,EVENT_TYPE_BOTH:3},init:function(){r.config={},r.log("initializing..."),window.ApolloVConfig&&(r.log("found global config object"),r.config=window.ApolloVConfig),r.config.dataProviders&&(r.dataProviders=r.config.dataProviders)},registerForPropertyChange:function(t,e,n){r.watchers[e]||(r.watchers[e]=[],r.lastWatchData[e]={time:0,value:null}),r.watchers[e].push({vue:t,propertyName:e,watchFn:n})},reportPropertyChanged:function(t,e,n,i){if(r.watchers[e]){var a=(new Date).getTime();if(r.lastWatchData[e]||(r.lastWatchData[e]={time:0,value:null}),r.isValueEquals(n,r.lastWatchData[e].value,!0)&&a-r.lastWatchData[e].time<500)return void r.debug("ignoring the data sync event since it is the same data in short period of time","DataSyncMixin");for(var o=0;o<r.watchers[e].length;o++)t!==r.watchers[e].vue&&r.watchers[e][o].watchFn(e,n,i);r.lastWatchData[e]={time:a,value:n}}},isValueEquals:function(t,e,n){switch(typeof t){case"string":case"number":case"boolean":return t===e}return t?t===e?!0:n?JSON.stringify(t)===JSON.stringify(e):!1:t===e},getComponentTagName:function(t){return t.$options&&t.$options.el&&t.$options.el.tagName?t.$options.el.tagName.toLowerCase():"n/a"},kebabToCamel:function(t){for(var e=t.split("-"),n=e[0],i=1;i<e.length;i++)n+=r.capitalize(e[i]);return n},capitalize:function(t){return t.substr(0,1).toUpperCase()+t.substr(1)},log:function(t){window.console&&window.console.log&&!r.config.noLog&&console.log("[ApolloV Info] "+t)},warn:function(t,e){window.console&&window.console.warn&&!r.config.noLog&&(console.warn("[ApolloV warn] "+t),console.warn((e||new Error("Warning Stack Trace")).stack))},debug:function(t,e){e=e||"Global",window.console&&window.console.log&&r.config.debug&&console.log("[ApolloV Debug|"+e+"] "+t)},isMixinExist:function(t,e){for(var n=0;n<t.length;n++)if(t[n]===e)return!0;return!1},http:function(t){return new Promise(function(e,n){r.config.http?r.config.http(t).then(function(t){e(t)}.bind(this)):window.jQuery?window.jQuery.ajax({method:"GET",url:t,success:function(t,n,i){e(t)}.bind(this)}):r.warn("can't make HTTP request. Either use jquery or set in the config the http property.")}.bind(this))},getTemplateUrl:function(t){return r.config.templateId2URL?r.config.templateId2URL(t):"/"+t},getDataProvidersNamespaceObj:function(){var t=r.config.dataProviderNamespace;if(!t)return null;if("string"!=typeof t)return t;if("window"===t)return window;var e=t.split("."),n="",i=window,a=0;"window"===e[0]&&(a=1);for(var o=a;o<e.length;o++){if(n+=(n.length?".":"")+e[o],!i[e[o]])return r.warn("failed to reach data provider namespace, couldn't find "+n),null;i=i[e[o]]}return i},getDataProviderObject:function(t){if(!t||!t.length)return r.warn("please provide data provider name"),null;var e;if(!r.dataProviders[t]){if(r.config.dataProviderName2Obj){if(e=r.config.dataProviderName2Obj(t))return e;r.log("dataProviderName2Obj return null for "+t)}var n=r.getDataProvidersNamespaceObj();return n&&n[t]?n[t]:r.config.defaultDataProvider?r.config.defaultDataProvider:(r.warn("there is no data provider matching the name "+t),null)}return r.dataProviders[t]},injectGlobalMixins:function(t,e){t.mixins||(t.mixins=[]);var n=t.mixins,i=[];if(r.config.globalMixins)if("function"!=typeof r.config.globalMixins)r.warn("globalMixins was defined in the config but it is not a function so it is ignored");else{var a=r.config.globalMixins(e);if(a&&a.length)for(var o=0;o<a.length;o++)a[o]?i.push(a[o]):r.warn("undefined mixin returned by globalMixins function (index "+o+")")}t.mixins=i;for(var o=0;o<n.length;o++)r.isMixinExist(t.mixins,n[o])||t.mixins.push(n[o])}},s={config:{setConfig:function(t){r.config=t}},mixins:{asyncInit:t,template:o,dynamicTemplate:i,dataProvider:e,events:a,dataSync:n},templates:{load:function(t){return new Promise(function(e,n){r.http(r.getTemplateUrl(t)).then(function(t){e(t)}.bind(this))}.bind(this))}},data:{registerProvider:function(t,e){r.dataProviders[t]&&r.log("overriding existing data provider "+t),r.dataProviders[t]=e}},components:{render:function(t){t=t||"body";var e=$(t),n=Object.keys(Vue.options.components);e.find(n.toString()).each(function(t,e){var n=e.tagName.toLowerCase();new Vue.options.components[n]({el:e})}.bind(this))},create:function(t,e){if("string"==typeof t||e||(e=t,t=null),"function"==typeof e)return void Vue.component(t,function(n){e(function(e){r.injectGlobalMixins(e,t),n(e)})}.bind(this));r.injectGlobalMixins(e,t);var n=Vue.extend(e);return t&&Vue.component(t,n),n}}};r.init(),window.ApolloV=s}();